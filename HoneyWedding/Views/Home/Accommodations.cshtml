
@model List<HoneyWedding.Models.AccommodationViewModel>

@{
    ViewBag.Title = "Staying There";
    Layout = "~/views/shared/_layoutBlank.cshtml";

}

<div class="mdl-grid">
    <div class="mdl-cell mdl-cell--6-col-desktop mdl-cell--4-col-tablet mdl-cell--4-col-phone">
        <div class="mdl-card mdl-shadow--2dp">
            <div class="mdl-card__title">
                @*<h2 class="mdl-card__title-text">@ViewBag.Title</h2>*@
            </div>
            <div class="mdl-card__supporting-text">
                <table class="mdl-data-table mdl-js-data-table">
                    <thead>
                    <th class="mdl-data-table__cell--non-numeric">
                        @Html.DisplayNameFor(model => model.FirstOrDefault().LocationName)
                    </th>
                    <th class="mdl-data-table__cell">
                        @Html.DisplayNameFor(model => model.FirstOrDefault().PriceRange)
                    </th>
                    <th class="mdl-data-table__cell">
                        @Html.DisplayNameFor(model => model.FirstOrDefault().RoomFor)
                    </th>
                    </thead>

                    @foreach (var item in Model)
                    {
                        <tr onclick="loadAccommodation(@item.ID)">
                            <td class="mdl-data-table__cell--non-numeric">
                                @Html.DisplayFor(modelItem => item.LocationName)
                            </td>
                            <td class="mdl-data-table__cell">
                                @Html.DisplayFor(modelItem => item.PriceRange)
                            </td>
                            <td class="mdl-data-table__cell">
                                @Html.DisplayFor(modelItem => item.RoomFor)
                            </td>
                        </tr>
                    }

                </table>

            </div>
        </div>

    </div>

    <div class="mdl-cell mdl-cell--6-col-desktop mdl-cell--4-col-tablet mdl-cell--4-col-phone">
        <div class="mdl-card mdl-shadow--2dp" id="accommodationDetail"></div>
    </div>
</div>

@section scripts {
    <script type="text/javascript">

        var accommodationDetailUrl = '@Url.Action("AccommodationDetail")';
        var accommodationDetail = $('#accommodationDetail');

        $(document).ready(loadAccommodation(@Model.FirstOrDefault().ID, true));

        function loadAccommodation(accommodationId, pageLoad = false) {
            // clear html from target div
            accommodationDetail.html('');

            // create spinner for loading
            var spinner = document.createElement('div');
            spinner.className = 'mdl-spinner mdl-js-spinner is-active';
            spinner.style.margin = 'auto auto';
            if (!pageLoad) // no upgrade needed on page load, mdl will upgrade automatically
            {
                componentHandler.upgradeElement(spinner);
            }
            document.getElementById('accommodationDetail').appendChild(spinner);

            // ajax call
            accommodationDetail.load(accommodationDetailUrl, { id: accommodationId });
        }

    </script>
}